<link rel="stylesheet" href="/css/cards.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">


@model IEnumerable<Sub_Application_1.DTOs.PostDto>
@using Sub_Application_1.DTOs


@if (Model == null || !Model.Any())
{
	<p>No posts available.</p>
}
else
{
	@foreach (var post in Model)
	{
		<div class="card mb-4 shadow-sm" style="border-radius: 10px; overflow: hidden; width: 30rem;">
			<!-- CARD HEADER -->
			<div class="d-flex align-items-center p-3" style="background-color: #f8f9fa;">
				<a href="/profile/@post.Author?.Username" class="text-decoration-none d-flex align-items-center">
					<img src="@post.Author?.ProfilePictureUrl" alt="Profile Picture" class="rounded-circle me-2"
						style="width: 50px; height: 50px; object-fit: cover;">
					<div>
						<h5 class="mb-0">@post.Author?.Username</h5>
						<small class="text-muted">@post.DateUploaded.ToString("MMM dd, yyyy")</small>
					</div>
				</a>
			</div>

			<!-- CARD BODY -->
			<div class="card-body" style="font-size: 16px; color: #000000; background-color: #ffffff;">
				@if (!string.IsNullOrEmpty(post.TextContent))
				{
					<p class="mb-3">@post.TextContent</p>
				}
				@if (!string.IsNullOrEmpty(post.ImagePath))
				{
					<div class="image-container">
						<img src="@post.ImagePath" alt="Post Image" class="img-fluid rounded">
					</div>
				}
			</div>

			<!-- CARD FOOTER -->
			<div class="d-flex justify-content-between align-items-center p-3" style="background-color: #f8f9fa;">
				<button class="btn btn-light d-flex align-items-center ms-4 toggle-comments" style="border-radius: 50%;">
					<i class="bi bi-heart"></i> <span>@post.LikesCount</span>
				</button>

				<!-- Comments Toggle -->
				@using (Html.BeginForm("GetCommentsForPost", "Comments", FormMethod.Get, new { @class = "d-inline" }))
				{
					<input type="hidden" name="postId" value="@post.PostId" />
					<button type="submit" class="btn btn-light d-flex align-items-center ms-4">
						<i class="bi bi-chat"></i> View Comments
					</button>
				}
			</div>

			<!-- COMMENTS SECTION -->
			@if (ViewBag.ActivePostId == post.PostId)
			{
				<div id="comments-container-@post.PostId">
					@{
						@Html.Partial("_CommentsPartial", (IEnumerable<CommentDto>)ViewBag.Comments)

					}

				</div>
			}
		</div>
	}
}
